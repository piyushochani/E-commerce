{"ast":null,"code":"import React,{createContext,useState,useEffect,useContext}from'react';import{cartService}from'../services/cartService';import{AuthContext}from'./AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";export const CartContext=/*#__PURE__*/createContext();export const CartProvider=_ref=>{let{children}=_ref;const[cart,setCart]=useState(null);const[cartItems,setCartItems]=useState([]);const[loading,setLoading]=useState(false);const{isCustomer,isAuthenticated}=useContext(AuthContext);const fetchCart=async()=>{if(!isCustomer||!isAuthenticated)return;try{setLoading(true);const response=await cartService.getCart();setCart(response.data.cart);setCartItems(response.data.cartItems);}catch(error){console.error('Error fetching cart:',error);}finally{setLoading(false);}};useEffect(()=>{if(isCustomer&&isAuthenticated){fetchCart();}},[isCustomer,isAuthenticated]);const addToCart=async function(productId){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;try{await cartService.addToCart(productId,quantity);await fetchCart();return{success:true};}catch(error){return{success:false,error};}};const updateCartItem=async(cartItemId,quantity)=>{try{await cartService.updateCartItem(cartItemId,quantity);await fetchCart();return{success:true};}catch(error){return{success:false,error};}};const removeFromCart=async cartItemId=>{try{await cartService.removeFromCart(cartItemId);await fetchCart();return{success:true};}catch(error){return{success:false,error};}};const clearCart=async()=>{try{await cartService.clearCart();await fetchCart();return{success:true};}catch(error){return{success:false,error};}};const getCartCount=()=>{return(cart===null||cart===void 0?void 0:cart.cart_quantity)||0;};const getCartTotal=()=>{return(cart===null||cart===void 0?void 0:cart.cart_total_amount)||0;};return/*#__PURE__*/_jsx(CartContext.Provider,{value:{cart,cartItems,loading,fetchCart,addToCart,updateCartItem,removeFromCart,clearCart,getCartCount,getCartTotal},children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","cartService","AuthContext","jsx","_jsx","CartContext","CartProvider","_ref","children","cart","setCart","cartItems","setCartItems","loading","setLoading","isCustomer","isAuthenticated","fetchCart","response","getCart","data","error","console","addToCart","productId","quantity","arguments","length","undefined","success","updateCartItem","cartItemId","removeFromCart","clearCart","getCartCount","cart_quantity","getCartTotal","cart_total_amount","Provider","value"],"sources":["C:/Users/piyus/OneDrive/Documents/Workspaces/E-commerce/frontend/src/context/CartContext.jsx"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\r\nimport { cartService } from '../services/cartService';\r\nimport { AuthContext } from './AuthContext';\r\n\r\nexport const CartContext = createContext();\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const [cart, setCart] = useState(null);\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const { isCustomer, isAuthenticated } = useContext(AuthContext);\r\n\r\n  const fetchCart = async () => {\r\n    if (!isCustomer || !isAuthenticated) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      const response = await cartService.getCart();\r\n      setCart(response.data.cart);\r\n      setCartItems(response.data.cartItems);\r\n    } catch (error) {\r\n      console.error('Error fetching cart:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isCustomer && isAuthenticated) {\r\n      fetchCart();\r\n    }\r\n  }, [isCustomer, isAuthenticated]);\r\n\r\n  const addToCart = async (productId, quantity = 1) => {\r\n    try {\r\n      await cartService.addToCart(productId, quantity);\r\n      await fetchCart();\r\n      return { success: true };\r\n    } catch (error) {\r\n      return { success: false, error };\r\n    }\r\n  };\r\n\r\n  const updateCartItem = async (cartItemId, quantity) => {\r\n    try {\r\n      await cartService.updateCartItem(cartItemId, quantity);\r\n      await fetchCart();\r\n      return { success: true };\r\n    } catch (error) {\r\n      return { success: false, error };\r\n    }\r\n  };\r\n\r\n  const removeFromCart = async (cartItemId) => {\r\n    try {\r\n      await cartService.removeFromCart(cartItemId);\r\n      await fetchCart();\r\n      return { success: true };\r\n    } catch (error) {\r\n      return { success: false, error };\r\n    }\r\n  };\r\n\r\n  const clearCart = async () => {\r\n    try {\r\n      await cartService.clearCart();\r\n      await fetchCart();\r\n      return { success: true };\r\n    } catch (error) {\r\n      return { success: false, error };\r\n    }\r\n  };\r\n\r\n  const getCartCount = () => {\r\n    return cart?.cart_quantity || 0;\r\n  };\r\n\r\n  const getCartTotal = () => {\r\n    return cart?.cart_total_amount || 0;\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider\r\n      value={{\r\n        cart,\r\n        cartItems,\r\n        loading,\r\n        fetchCart,\r\n        addToCart,\r\n        updateCartItem,\r\n        removeFromCart,\r\n        clearCart,\r\n        getCartCount,\r\n        getCartTotal\r\n      }}\r\n    >\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}